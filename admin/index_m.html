<html>

<head>

	<!-- Load ioBroker scripts and styles-->
	<link rel="stylesheet" type="text/css" href="../../lib/css/fancytree/ui.fancytree.min.css" />
	<link rel="stylesheet" type="text/css" href="../../css/adapter.css" />
	<link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css">

	<script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="../../socket.io/socket.io.js"></script>

	<script type="text/javascript" src="../../lib/js/materialize.js"></script>
	<script type="text/javascript" src="../../lib/js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../lib/js/jquery.fancytree-all.min.js"></script>

	<script type="text/javascript" src="../../js/translate.js"></script>
	<script type="text/javascript" src="../../lib/js/selectID.js"></script>
	<script type="text/javascript" src="../../js/adapter-settings.js"></script>


	<!-- my own styles -->
	<link rel="stylesheet" type="text/css" href="style.css" />
	<script type="text/javascript" src="words.js"></script>

	<style>

        #dialog-device-edit {
            max-height: 95% !important;
            max-width: 85% !important;
            width: 80% !important;
            height: 90% !important;
            overflow: visible !important;
            top: 10px !important;
        }

		#dialog-select-member {
			max-height: 95% !important;
			max-width: 85% !important;
			width: 80% !important;
			height: 90% !important;
			overflow: visible !important;
			top: 10px !important;
		}

		.collapsible-body {
			margin-left: 2rem !important;
			padding-top: 0 !important;
		}

		redlabel {
			color: red;
		}
	</style>


	<script type="text/javascript">



		function showHideSettings() {
            console.log("showHideSettings");
 
			if ($('#DeviceInterruptionAllowed').prop("checked")) {
                console.log("show DeviceInterruptionAllowed");
				$('#divDeviceMinOnTime').show();
				$('#divDeviceMaxOnTime').show();
				$('#divDeviceMinOffTime').show();
				$('#divDeviceMaxOffTime').show();
			}
			else {
                console.log("hide DeviceInterruptionAllowed");
                $('#divDeviceMinOnTime').hide();
                $('#divDeviceMaxOnTime').hide();
                $('#divDeviceMinOffTime').hide();
                $('#divDeviceMaxOffTime').hide();
            }

			if ($('#DeviceMeasurementMethod').val() == "Measurement") {
                console.log("show DeviceMeasurementMethod");
				$('#divDeviceOIDPower').show();

			}
			else {
                console.log("hide DeviceMeasurementMethod");
                $('#divDeviceOIDPower').hide();
            }

            if ($('#DeviceStatusDetectionType').val() == "SeparateOID") {
                console.log("show DeviceStatusDetectionType");
				$('#divDeviceOIDStatus').show();
                

            }
            else {
                console.log("hide DeviceStatusDetectionType");
                $('#divDeviceOIDStatus').hide();
            }

			
            if ($('#DeviceHasOIDSwitch').prop("checked")) {
                console.log("show DeviceHasOIDSwitch");
                $('#divDeviceOIDSwitch').show();

            }
            else {
                console.log("hide DeviceHasOIDSwitch");
                $('#divDeviceOIDSwitch').hide();
			}

            if ($('#DeviceStatusDetectionType').val() == "FromPowerValue" ) {
                $('#divDeviceStatusDetectionLimit').show();
            }
            else {
                $('#divDeviceStatusDetectionLimit').hide();
            }

			/*
			 * only if detection from power value, otherwise we believe what we get
            if ($('#DeviceStatusDetectionType').val() == "FromPowerValue" || $('#DeviceStatusDetectionType').val() == "SeparateOID") {
				$('#divDeviceStatusDetectionLimit').show();
			}
			else {
                $('#divDeviceStatusDetectionLimit').hide();
            }
			*/

            if ($('#DeviceTimerActive').prop("checked")) {
                console.log("show DeviceTimerActive");
				$('#divDeviceTimer').show();
                $('#divDeviceRunningTime').show();

            }
            else {
                console.log("hide DeviceTimerActive");
				$('#divDeviceTimer').hide();
                $('#divDeviceRunningTime').hide();
            }

            divDeviceTimerMonday
			if ($('#DeviceTimerEveryDay').prop("checked")) {
                console.log("show DeviceTimerEveryDay");
                $('#divDeviceTimerMonday').hide();
				$('#divDeviceTimerTuesday').hide();
				$('#divDeviceTimerWednesday').hide();
				$('#divDeviceTimerThursday').hide();
				$('#divDeviceTimerFriday').hide();
				$('#divDeviceTimerSaturday').hide();
                $('#divDeviceTimerSunday').hide();
			}
			else {
                console.log("hide DeviceTimerEveryDay");
                $('#divDeviceTimerMonday').show();
                $('#divDeviceTimerTuesday').show();
                $('#divDeviceTimerWednesday').show();
                $('#divDeviceTimerThursday').show();
                $('#divDeviceTimerFriday').show();
                $('#divDeviceTimerSaturday').show();
                $('#divDeviceTimerSunday').show();
            }


		}


		function CheckIP(onChange, instance) {
			console.log("CheckIP");
			var $ip = $('#IPAddress');

			if (!$ip.val() || $ip.val().length < 5) {
				console.log("call get IP from " + instance);
				getIP(onChange, instance);
			}
		}

		//var timeout1;
		function getIP(onChange, instance) {
			//timeout1 = setTimeout(function () {
			//    getIP(onChange, instance);
			//}, 4000);

			//function sendTo(_adapter_instance, command, message, callback)
			sendTo(instance, 'getIP', null, function (list) {
				//if (timeout1) {
				//    clearTimeout(timeout1);
				//    timeout1 = null;
				//}

				console.log('got ip ' + JSON.stringify(list));

				$('#IPAddress').val(list);

				showHideSettings();
				onChange(true);
				M.updateTextFields();

			});
		}



		function CheckUUID(onChange, instance) {
			console.log("CheckUUID");
			var $uuid = $('#UUID');

			if (!$uuid.val() || $uuid.val().length < 5) {
				console.log("call get UUID from " + instance);
				getUUID(onChange, instance);
			}

		}

		//var timeout2;
		function getUUID(onChange, instance) {
			//timeout2 = setTimeout(function () {
			//    getUUID(onChange, instance);
			//}, 4000);

			//function sendTo(_adapter_instance, command, message, callback)
			sendTo(instance, 'getUUID', null, function (list) {
				//if (timeout2) {
				//    clearTimeout(timeout2);
				//    timeout2 = null;
				//}

				console.log('got uuid ' + JSON.stringify(list));

				$('#UUID').val(list);

				showHideSettings();
				onChange(true);
				M.updateTextFields();

			});
		}

		function CheckDeviceBaseId(onChange, instance) {
			console.log("CheckDeviceBaseId");
			var $devicebaseid = $('#DeviceBaseID');

			if (!$devicebaseid.val() || $devicebaseid.val() < 1000) {
				console.log("call get $devicebaseid from " + instance);
				getDeviceBaseId(onChange, instance);
			}
		}

		//var timeout3;
		function getDeviceBaseId(onChange, instance) {
			//timeout3 = setTimeout(function () {
			//    getDeviceBaseId(onChange, instance);
			//}, 4000);

			//function sendTo(_adapter_instance, command, message, callback)
			sendTo(instance, 'getDeviceBaseID', null, function (list) {
				//if (timeout3) {
				//    clearTimeout(timeout3);
				//    timeout3 = null;
				//}

				console.log('got DeviceBaseID ' + JSON.stringify(list));

				$('#DeviceBaseID').val(list);

				showHideSettings();
				onChange(true);
				M.updateTextFields();

			});
		}

		let devices = null;

		// This will be called by the admin adapter when the settings page loads
		function load(settings, onChange) {
			// example: select elements with id=key and class=value and insert value
			if (!settings) return;
			$('.value').each(function () {
				var $key = $(this);
				var id = $key.attr('id');
				if ($key.attr('type') === 'checkbox') {
					// do not call onChange direct, because onChange could expect some arguments
					$key.prop('checked', settings[id])
						.on('change', () => onChange())
						;
				} else {
					// do not call onChange direct, because onChange could expect some arguments
					$key.val(settings[id])
						.on('change', () => onChange())
						.on('keyup', () => onChange())
						;
				}
			});
			onChange(false);

			var _id = 'semp.' + instance;
			CheckIP(onChange, _id);
			CheckUUID(onChange, _id);
			CheckDeviceBaseId(onChange, _id);

			showHideSettings();

			devices = settings.devices;

			// reinitialize all the Materialize labels on the page if you are dynamically adding inputs:
			if (M) M.updateTextFields();

			values2table('devices', settings.devices, onChange, tableDevicesOnReady);

			$('#addNewDevice').on('click', function () {
				
				let temp_devices = table2values('devices');
				id = temp_devices.length;

                console.log("new device add " + id);
				setTimeout(function () {
					//define ID F-11223344-112233445566-00
					var $devicebaseid = $('#DeviceBaseID');
					var deviceid = "F-" + $devicebaseid.val() + "-" + ("000000000000" + (id + 1)).slice(-12) + "-00";

					$('#devices .values-input[data-name="Name"][data-index="' + id + '"]').val("newDevice" + id);
                    $('#devices .values-input[data-name="IsActive"][data-index="' + id + '"]').prop('checked', true);
					$('#devices .values-input[data-name="ID"][data-index="' + id + '"]').val(deviceid);
				}, 100);
			});


			$("#refresh-baseid").click(function () {
				getDeviceBaseId(onChange, _id);
			});

			$("#refresh-uuid").click(function () {
				getUUID(onChange, _id);
			});


            

		}

		function initDialogDevice(id, device, callback) {

			console.log('initDialogDevice ' + device + " " + id);

			var $editDialog = $('#dialog-device-edit');
			if (!$editDialog.data('inited')) {

				console.log('init dialog ');

				$editDialog.data('inited', true);
				$editDialog.modal({
					dismissible: false
				});

				$editDialog.find('.btn-set').on('click', function () {
					var $editDialog = $('#dialog-device-edit');
					var callback = $editDialog.data('callback');
					if (typeof callback === 'function') callback();
					$editDialog.data('callback', null);
				});
			}

            $editDialog.data('callback', callback);
			$editDialog.modal('open');

            $("#DeviceInterruptionAllowed").change( function () {
                showHideSettings();
			});
            $("#DeviceMeasurementMethod").change(function () {
                showHideSettings();
			});
            $("#DeviceHasOIDSwitch").change(function () {
                showHideSettings();
            });
            $("#DeviceStatusDetectionType").change(function () {
                showHideSettings();
            });
            $("#DeviceTimerActive").change(function () {
                showHideSettings();
			});
            $("#DeviceTimerEveryDay").change(function () {
                showHideSettings();
            });
			
			//$("#DeviceTimerDays").change(function () {
			//	console.log("DeviceTimerDays " + $("#DeviceTimerDays").val());
			//});

            $('#SelectDeviceOIDPower').on('click', function () {
                initSelectId(function (sid) {
                    sid.selectId('show', $('#DeviceOIDPower').val(), function (newId) {
                        if (newId) {
                            $('#DeviceOIDPower').val(newId).trigger('change');
                        }
                    });
                });
            });
            $('#SelectDeviceOIDSwitch').on('click', function () {
                initSelectId(function (sid) {
                    sid.selectId('show', $('#DeviceOIDSwitch').val(), function (newId) {
                        if (newId) {
                            $('#DeviceOIDSwitch').val(newId).trigger('change');
                        }
                    });
                });
			});
            $('#SelectDeviceOIDStatus').on('click', function () {
                initSelectId(function (sid) {
                    sid.selectId('show', $('#DeviceOIDStatus').val(), function (newId) {
                        if (newId) {
                            $('#DeviceOIDStatus').val(newId).trigger('change');
                        }
                    });
                });
            });


			//fill input elements a bit later
			setTimeout(function () {

				$('#IndexID').val(id);

				//Name, ID und IsActive aus Tabelle holen
				let temp_devices = table2values('devices');
				let deviceisActive = temp_devices[id].IsActive;
				let deviceid = temp_devices[id].ID;
				let devicename = temp_devices[id].Name;

				$('#DeviceIsActive').prop("checked", deviceisActive)

				$('#DeviceID').val(deviceid);
				$('#DeviceVendor').val(devices[id].Vendor);
				$('#DeviceName').val(devicename);
				$('#DeviceType').val(devices[id].Type);
				$('#DeviceType').select();

				$('#DeviceSerialnumber').val(devices[id].SerialNr);
				$('#DeviceMaxPower').val(devices[id].MaxPower);
				$('#DeviceInterruptionAllowed').prop("checked", devices[id].InterruptionsAllowed);

				$('#DeviceMinOnTime').val(devices[id].MinOnTime);
				$('#DeviceMaxOnTime').val(devices[id].MaxOnTime);
				$('#DeviceMinOffTime').val(devices[id].MinOffTime);
				$('#DeviceMaxOffTime').val(devices[id].MaxOffTime);

				$('#DeviceMeasurementMethod').val(devices[id].MeasurementMethod);
				$('#DeviceMeasurementMethod').select();

				$('#DeviceOIDPower').val(devices[id].OID_Power);

				$('#DeviceStatusDetectionType').val(devices[id].StatusDetection);
				$('#DeviceStatusDetectionType').select();
                $('#DeviceStatusDetectionLimit').val(devices[id].StatusDetectionLimit);
                $('#DeviceStatusDetectionLimitTime').val(devices[id].StatusDetectionLimitTime);

				$('#DeviceOIDStatus').val(devices[id].OID_Status);

                $('#DeviceHasOIDSwitch').prop("checked", devices[id].HasOIDSwitch);
				$('#DeviceOIDSwitch').val(devices[id].OID_Switch);

				$('#DeviceTimerActive').prop("checked", devices[id].TimerActive);
				$('#DeviceTimerStart').val(devices[id].TimerStart);
				$('#DeviceTimerEnd').val(devices[id].TimerEnd);
				//$('#DeviceTimerDays').val(devices[id].TimerDays);

                $('#DeviceTimerEveryDay').prop("checked", devices[id].TimerEveryDay);
                $('#DeviceTimerMonday').prop("checked", devices[id].TimerMonday);
                $('#DeviceTimerTuesday').prop("checked", devices[id].TimerTuesday);
                $('#DeviceTimerWednesday').prop("checked", devices[id].TimerWednesday);
                $('#DeviceTimerThursday').prop("checked", devices[id].TimerThursday);
                $('#DeviceTimerFriday').prop("checked", devices[id].TimerFriday);
                $('#DeviceTimerSaturday').prop("checked", devices[id].TimerSaturday);
                $('#DeviceTimerSunday').prop("checked", devices[id].TimerSunday);


				$('#DeviceTimerMinRunningtime').val(devices[id].TimerMinRunTime);
				$('#DeviceTimerMaxRunningtime').val(devices[id].TimerMaxRunTime);

				showHideSettings();

				if (M) M.updateTextFields();

			}, 100);


		}


		function tableDevicesOnReady() {
			console.log('tableDevicesOnReady');
			$('#devices .table-values-div .table-values .values-buttons[data-command="edit"]').on('click', function () {

				let id = $(this).data('index');

				console.log('edit devices clicked ID=' + id);

				let device = $('#devices .values-input[data-name="Name"][data-index="' + id + '"]').val();
				$('#dialogEditDevice').html(device);

				setTimeout(function () {
					initDialogDevice(id, device, function () {

						//this is reached when dialog is closing
						let device = $('#dialogEditDevice')[0].innerHTML;

						let id = $('#IndexID').val();

						console.log('closing for ' + device + " " + id);

						devices[id].IsActive = $('#DeviceIsActive').prop("checked");
						devices[id].ID = $('#DeviceID').val();
						devices[id].Vendor = $('#DeviceVendor').val();
						devices[id].Name = $('#DeviceName').val();
						devices[id].Type = $('#DeviceType').val();
						devices[id].SerialNr = $('#DeviceSerialnumber').val();
						devices[id].MaxPower = $('#DeviceMaxPower').val();
						devices[id].InterruptionsAllowed = $('#DeviceInterruptionAllowed').prop("checked");
						devices[id].MinOnTime = $('#DeviceMinOnTime').val();
						devices[id].MaxOnTime = $('#DeviceMaxOnTime').val();
						devices[id].MinOffTime = $('#DeviceMinOffTime').val();
						devices[id].MaxOffTime = $('#DeviceMaxOffTime').val();
						devices[id].MeasurementMethod = $('#DeviceMeasurementMethod').val();
						devices[id].OID_Power = $('#DeviceOIDPower').val();
						devices[id].StatusDetection = $('#DeviceStatusDetectionType').val();
                        devices[id].StatusDetectionLimit = $('#DeviceStatusDetectionLimit').val();
						devices[id].StatusDetectionLimitTime = $('#DeviceStatusDetectionLimitTime').val();

						devices[id].OID_Status = $('#DeviceOIDStatus').val();

                        devices[id].HasOIDSwitch = $('#DeviceHasOIDSwitch').prop("checked");
						devices[id].OID_Switch = $('#DeviceOIDSwitch').val();

                        devices[id].TimerActive = $('#DeviceTimerActive').prop("checked");
                        devices[id].TimerStart = $('#DeviceTimerStart').val();
                        devices[id].TimerEnd = $('#DeviceTimerEnd').val();
                        //devices[id].TimerDays = $('#DeviceTimerDays').val();

                        devices[id].TimerEveryDay = $('#DeviceTimerEveryDay').prop("checked");
                        devices[id].TimerMonday = $('#DeviceTimerMonday').prop("checked");
                        devices[id].TimerTuesday = $('#DeviceTimerTuesday').prop("checked");
                        devices[id].TimerWednesday = $('#DeviceTimerWednesday').prop("checked");
                        devices[id].TimerThursday = $('#DeviceTimerThursday').prop("checked");
                        devices[id].TimerFriday = $('#DeviceTimerFriday').prop("checked");
                        devices[id].TimerSaturday = $('#DeviceTimerSaturday').prop("checked");
                        devices[id].TimerSunday = $('#DeviceTimerSunday').prop("checked");

                        devices[id].TimerMinRunTime = $('#DeviceTimerMinRunningtime').val();
                        devices[id].TimerMaxRunTime = $('#DeviceTimerMaxRunningtime').val();

						CheckDeviceData(id);
						//tabelle updaten nicht notwendig, da hier keine Daten aus der Tabelle geändert werden

					})
				}, 20);
			});
		}

		function CheckDeviceData(id) {
			console.log("CheckDeviceData " + id);

			console.log(id + " " + typeof devices[id].StatusDetectionLimit + " " + devices[id].StatusDetectionLimit);
			if (typeof devices[id].StatusDetectionLimit == undefined || devices[id].StatusDetectionLimit == null || devices[id].StatusDetectionLimit == "") {
				console.log("set StatusDetectionLimit=0 ");
				devices[id].StatusDetectionLimit = 0;
			}
			console.log(id + " " + typeof devices[id].StatusDetectionLimitTime + " " + devices[id].StatusDetectionLimitTime);
			if (typeof devices[id].StatusDetectionLimitTime == undefined || devices[id].StatusDetectionLimitTime == null || devices[id].StatusDetectionLimitTime == "") {
				console.log("set StatusDetectionLimitTime=0 ");
				devices[id].StatusDetectionLimitTime = 0;
			}
		}

		var selectId;
		function initSelectId(callback) {

			if (selectId) {
				return callback(selectId);
			}

			socket.emit('getObjects', function (err, objs) {
				selectId = $('#dialog-select-member').selectId('init', {
					noMultiselect: true,
					objects: objs,
					imgPath: '../../lib/css/fancytree/',
					filter: { type: 'state' },
					name: 'scenes-select-state',
					texts: {
						select: _('Select'),
						cancel: _('Cancel'),
						all: _('All'),
						id: _('ID'),
						name: _('Name'),
						role: _('Role'),
						room: _('Room'),
						value: _('Value'),
						selectid: _('Select ID'),
						from: _('From'),
						lc: _('Last changed'),
						ts: _('Time stamp'),
						wait: _('Processing...'),
						ack: _('Acknowledged'),
						selectAll: _('Select all'),
						unselectAll: _('Deselect all'),
						invertSelection: _('Invert selection')
					},
					columns: ['image', 'name', 'role', 'room']
				});
				callback(selectId);
			});
		}


		// This will be called by the admin adapter when the user presses the save button
		function save(callback) {
			// example: select elements with class=value and build settings object
			var obj = {};
			$('.value').each(function () {
				var $this = $(this);
				if ($this.attr('type') === 'checkbox') {
					obj[$this.attr('id')] = $this.prop('checked');
				} else if ($this.attr('type') === 'number') {
					obj[$this.attr('id')] = parseFloat($this.val());
				} else {
					obj[$this.attr('id')] = $this.val();
				}
			});

			//use devices data instead table and update from table
            let temp_devices = table2values('devices');
			for (let d = 0; d < temp_devices.length; d++) {
                devices[d].IsActive = temp_devices[d].IsActive;
                devices[d].ID = temp_devices[d].ID;
                devices[d].Name = temp_devices[d].Name;
            }

			obj.devices = devices;

			callback(obj);
		}
	</script>

</head>

<body>

	<div class="m adapter-container">
		<div class="row">

			<div class="col s12">
				<ul class="tabs">
					<li class="tab col s2"><a href="#tab-main" class="translate active">Main settings</a></li>
					<li class="tab col s2 le-settings"><a href="#tab-devices" class="translate">devices</a></li>
				</ul>
			</div>

			<!--  main - settings  -->
			<div id="tab-main" class="col s12 page">
				<div class="row">
					<div class="col s6">
						<img src="semp.png" class="logo">
					</div>
				</div>

				<div class="row">
					<div class="input-field col s3">
						<input type="text" id="IPAddress" class="value" />
						<label for="IPAddress" class="translate">IPAddress</label>
					</div>

					<div class="input-field col s3">
						<input type="text" id="UUID" class="value" />
						<label for="UUID" class="translate">UUID</label>
					</div>
					<div class="col s1">
						<button class="btn-floating btn-small waves-effect waves-light" title="refresh-uuid" id="refresh-uuid">
							<i class="material-icons">refresh</i>
						</button>
					</div>
				</div>
				<div class="row">
					<div class="input-field col s3">
						<input type="number" id="SempPort" class="value" min="0" max="9999" />
						<label for="SempPort" class="translate">SempPort</label>
					</div>
				</div>
				<div class="row">
					<div class="input-field col s3">
						<input type="text" id="SempName" class="value" />
						<label for="SempName" class="translate">SempName</label>
					</div>

					<div class="input-field col s3">
						<input type="text" id="SempManufacturer" class="value" />
						<label for="SempManufacturer" class="translate">SempManufacturer</label>
					</div>
				</div>
				<div class="row">
					<div class="input-field col s3">
						<input type="checkbox" id="extendedLog" class="value" />
						<label for="extendedLog" class="translate">extendedLog</label>
					</div>
				</div>



			</div>





			<!--  settings for devices -->
			<div id="tab-devices" class="col s12 page">

				<div class="row">
					<div class="input-field col s3">
						<input type="number" id="DeviceBaseID" class="value" min="0" max="99999999" />
						<label for="DeviceBaseID" class="translate">DeviceBaseID</label>
					</div>
					<div class="col s1">
						<button class="btn-floating btn-small waves-effect waves-light" title="refresh-baseid" id="refresh-baseid">
							<i class="material-icons">refresh</i>
						</button>
					</div>
				</div>

				<div class="row">
					<div class="col s12" id="devices">

						<a id="addNewDevice" class="btn-floating waves-effect waves-light blue table-button-add" title="add device"><i class="material-icons">add</i></a>

						<div class="table-values-div">
							<table id="table_devices" class="table-values" style="width: 100%;">
								<thead>
									<tr>
										<th id="tableDevices_col1" data-name="IsActive" data-type="checkbox" style="background: #64b5f6 " class="header translate">IsActive</th>
										<th id="tableDevices_col2" data-name="ID" data-type="text" style="background: #64b5f6 " class="header translate">ID</th>
										<th id="tableDevices_col3" data-name="Name" data-type="text" style="background: #64b5f6 " class="headertranslate">Name</th>
										<th data-buttons="up down edit delete" style="width: 100px; background: #64b5f6"></th>
									</tr>
								</thead>
							</table>
						</div>

					</div>
				</div>
			</div>
		</div>

		<div class="m material-dialogs">
			<div id="dialog-select-member" class="modal modal-fixed-footer">
				<div class="modal-content">
					<div class="row">
						<div class="col s12 title"></div>
					</div>
					<div class="row">
						<div class="col s12 dialog-content">
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<a class="modal-action modal-close waves-effect waves-green btn btn-set"><i class="large material-icons left">check</i><span class="translate">Select</span></a>
					<a class="modal-action modal-close waves-effect waves-green btn btn-close"><i class="large material-icons left ">close</i><span class="translate">Cancel</span></a>
				</div>
			</div>

			<div id="dialog-device-edit" class="modal modal-fixed-footer">
				<div class="row">
					<div class="modal-content">

						<div class="row">
							<div class="col s12">
								<h6 class="title"><span class="translate">Edit Device:</span> <span id="dialogEditDevice"></span></h6>

								<!-- just to store table id / index-->
								<input type="hidden" id="IndexID" />



							</div>
						</div>
						<div class="col s12">
							<ul class="tabs">
								<li id="page-device-main" class="tab col s3"><a href="#tab-popup_device_main" class="translate" active>main settings</a></li>
								<li id="page-device-counter" class="tab col s3"><a href="#tab-popup_device_counter" class="translate">counter</a></li>
								<li id="page-device-switch" class="tab col s3"><a href="#tab-popup_device_switch" class="translate">switch</a></li>
								<li id="page-device-timers" class="tab col s3"><a href="#tab-popup_device_timers" class="translate">timers</a></li>
							</ul>
						</div>


						<!-- todo
								add:
									optionalEnergy
									url

								-->
						<!-- tab main-->
						<div id="tab-popup_device_main" class="col s12 page">
							<div class="row">
								<div class="col s12 ">
									<span class="translate">hint_main</span>
								</div>
							</div>

							<div class="row">
								<!-- these values are changeable in main overview table and not here in details-->
								<!--
								<div class="input-field col s3">
									<input type="checkbox" id="DeviceIsActive" class="value" />
									<label for="DeviceIsActive" class="translate">DeviceIsActive</label>
								</div>
									-->
								<div class="input-field col s3">
									<input type="text" id="DeviceID" class="value" readonly />
									<label for="DeviceID" class="translate">DeviceID</label>
								</div>
								<div class="input-field col s3">
									<input type="text" id="DeviceName" class="value" readonly />
									<label for="DeviceName" class="translate">DeviceName</label>
								</div>
							</div>
							<div class="row">
								<div class="input-field col s3">
									<input type="text" id="DeviceVendor" class="value" />
									<label for="DeviceVendor" class="translate">DeviceVendor</label>
								</div>
								<div class="input-field col s3">
									<input type="text" id="DeviceSerialnumber" class="value" />
									<label for="DeviceSerialnumber" class="translate">DeviceSerialnumber</label>
								</div>
								<div class="input-field col s3">

									<select id="DeviceType" class="value">
										<option value="AirConditioning" class="translate">AirConditioning</option>
										<option value="Charger" class="translate">Charger</option>
										<option value="DishWasher" class="translate">DishWasher</option>
										<option value="Dryer" class="translate">Dryer</option>
										<option value="ElectricVehicle" class="translate">ElectricVehicle</option>
										<option value="EVCharger" class="translate">EVCharger</option>
										<option value="Fridge" class="translate">Fridge</option>
										<option value="HeatPump" class="translate">HeatPump</option>
										<option value="Heater" class="translate">Heater</option>
										<option value="Motor" class="translate">Motor</option>
										<option value="Pump" class="translate">Pump</option>
										<option value="WashingMachine" class="translate">WashingMachine</option>
										<option value="Other" class="translate">Other</option>
									</select>
									<label for="DeviceType" class="translate">DeviceType</label>


								</div>
								
							</div>


							<div class="row">
								<div class="input-field col s3">
									<input type="number" id="DeviceMaxPower" class="value" />
									<label for="DeviceMaxPower" class="translate">DeviceMaxPower</label>
								</div>

								<div class="input-field col s3">
									<input type="checkbox" id="DeviceInterruptionAllowed" class="value" />
									<label for="DeviceInterruptionAllowed" class="translate">DeviceInterruptionAllowed</label>
								</div>

							</div>
							<div class="row">
								<div id="divDeviceMinOnTime" class="input-field col s3">
									<input type="number" id="DeviceMinOnTime" class="value" />
									<label for="DeviceMinOnTime" class="translate">DeviceMinOnTime</label>
								</div>
								<div id="divDeviceMaxOnTime" class="input-field col s3">
									<input type="number" id="DeviceMaxOnTime" class="value" />
									<label for="DeviceMaxOnTime" class="translate">DeviceMaxOnTime</label>
								</div>
								<div id="divDeviceMinOffTime" class="input-field col s3">
									<input type="number" id="DeviceMinOffTime" class="value" />
									<label for="DeviceMinOffTime" class="translate">DeviceMinOffTime</label>
								</div>
								<div id="divDeviceMaxOffTime" class="input-field col s3">
									<input type="number" id="DeviceMaxOffTime" class="value" />
									<label for="DeviceMaxOffTime" class="translate">DeviceMaxOffTime</label>
								</div>
							</div>
						</div>


						<!-- tab counter-->
						<div id="tab-popup_device_counter" class="col s12 page">
							<div class="row">
								<div class="col s12 ">
									<span class="translate">hint_counter</span>
								</div>
							</div>

							<div class="row">
								<div class="input-field col s3">
									<select id="DeviceMeasurementMethod" class="value">
										<option value="Measurement" class="translate">Measurement</option>
										<option value="Estimation" class="translate">Estimation</option>
									</select>
									<label for="DeviceMeasurementMethod" class="translate">DeviceMeasurementMethod</label>
								</div>
							</div>


							<div id="divDeviceOIDPower" class="row">
								<div class="input-field col s3">
									<input type="text" id="DeviceOIDPower" class="value" />
									<label for="DeviceOIDPower" class="translate">DeviceOIDPower</label>
								</div>

								<div class="col s1 m2 l1">
									<a id="SelectDeviceOIDPower" class="btn-floating waves-effect waves-light blue table-button-add"><i class="material-icons">edit</i></a>
								</div>

							</div>

						</div>

						<!-- tab switch-->
						<div id="tab-popup_device_switch" class="col s12 page">
							<div class="row">
								<div class="col s12 ">
									<span class="translate">hint_switch</span>
								</div>
							</div>


							<div class="row">
								<div class="input-field col s3">
									<select id="DeviceStatusDetectionType" class="value">
										<option value="SeparateOID" class="translate">SeparateOID</option>
										<option value="FromPowerValue" class="translate">FromPowerValue</option>
										<option value="AlwaysOn" class="translate">AlwaysOn</option>
									</select>
									<label for="DeviceStatusDetectionType" class="translate">DeviceStatusDetectionType</label>
								</div>
							</div>

							<div id="divDeviceOIDStatus" class="row">
								<div class="input-field col s3">
									<input type="text" id="DeviceOIDStatus" class="value" />
									<label for="DeviceOIDStatus" class="translate">DeviceOIDStatus</label>
								</div>
								<div class="col s1 m2 l1">
									<a id="SelectDeviceOIDStatus" class="btn-floating waves-effect waves-light blue table-button-add"><i class="material-icons">edit</i></a>
								</div>
							</div>


							<div id="divDeviceStatusDetectionLimit" class="row">
								<div class="input-field col s3">
									<input type="number" id="DeviceStatusDetectionLimit" class="value" min="0" />
									<label for="DeviceStatusDetectionLimit" class="translate">DeviceStatusDetectionLimit</label>
								</div>
								<div class="input-field col s3">
									<input type="number" id="DeviceStatusDetectionLimitTime" class="value" min="0" />
									<label for="DeviceStatusDetectionLimitTime" class="translate">DeviceStatusDetectionLimitTime</label>
								</div>
							</div>

							<div class="row">
								<div class="input-field col s3">
									<input type="checkbox" id="DeviceHasOIDSwitch" class="value" />
									<label for="DeviceHasOIDSwitch" class="translate">DeviceHasOIDSwitch</label>
								</div>
							</div>

							<div id="divDeviceOIDSwitch" class="row">
								<div class="input-field col s3">
									<input type="text" id="DeviceOIDSwitch" class="value" />
									<label for="DeviceOIDSwitch" class="translate">DeviceOIDSwitch</label>
								</div>
								<div class="col s1 m2 l1">
									<a id="SelectDeviceOIDSwitch" class="btn-floating waves-effect waves-light blue table-button-add"><i class="material-icons">edit</i></a>
								</div>
							</div>

						</div>


						<!-- tab timer-->
						<div id="tab-popup_device_timers" class="col s12 page">
							<div class="row">
								<div class="col s12 ">
									<span class="translate">hint_timer</span>
								</div>
							</div>

							<div class="row">
								<div class="input-field col s3">
									<input type="checkbox" id="DeviceTimerActive" class="value" />
									<label for="DeviceTimerActive" class="translate">DeviceTimerActive</label>
								</div>
							</div>

							<div class="row">
								<div id="divDeviceTimerEveryDay" class="input-field col s1">
									<input type="checkbox" id="DeviceTimerEveryDay" class="value" />
									<label for="DeviceTimerEveryDay" class="translate">DeviceTimerEveryDay</label>
								</div>
							</div>
							<div class="row">
								<div id="divDeviceTimerMonday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerMonday" class="value" />
									<label for="DeviceTimerMonday" class="translate">DeviceTimerMonday</label>
								</div>
								<div id="divDeviceTimerTuesday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerTuesday" class="value" />
									<label for="DeviceTimerTuesday" class="translate">DeviceTimerTuesday</label>
								</div>
								<div id="divDeviceTimerWednesday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerWednesday" class="value" />
									<label for="DeviceTimerWednesday" class="translate">DeviceTimerWednesday</label>
								</div>
								<div id="divDeviceTimerThursday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerThursday" class="value" />
									<label for="DeviceTimerThursday" class="translate">DeviceTimerThursday</label>
								</div>
								<div id="divDeviceTimerFriday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerFriday" class="value" />
									<label for="DeviceTimerFriday" class="translate">DeviceTimerFriday</label>
								</div>
								<div id="divDeviceTimerSaturday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerSaturday" class="value" />
									<label for="DeviceTimerSaturday" class="translate">DeviceTimerSaturday</label>
								</div>
								<div id="divDeviceTimerSunday" class="input-field col s2">
									<input type="checkbox" id="DeviceTimerSunday" class="value" />
									<label for="DeviceTimerSunday" class="translate">DeviceTimerSunday</label>
								</div>
							</div>


							<div id="divDeviceTimer" class="row">
								<div class="input-field col s3">
									<input type="text" id="DeviceTimerStart" class="value" />
									<label for="DeviceTimerStart" class="translate">DeviceTimerStart</label>
								</div>

								<div class="input-field col s3">
									<input type="text" id="DeviceTimerEnd" class="value" />
									<label for="DeviceTimerEnd" class="translate">DeviceTimerEnd</label>
								</div>

								<!--todo multiple select ???-->
								<!--
								<div class="input-field col s3">
									<select multiple id="DeviceTimerDays" class="value">
										<option value="everyDay" class="translate">every Day</option>
										<option value="Monday" class="translate">Monday</option>
										<option value="Tuesday" class="translate">Tuesday</option>
										<option value="Wednesday" class="translate">Wednesday</option>
										<option value="Thursday" class="translate">Thursday</option>
										<option value="Friday" class="translate">Friday</option>
										<option value="Saturday" class="translate">Saturday</option>
										<option value="Sunday" class="translate">Sunday</option>

									</select>
									<label for="DeviceTimerDays" class="translate">DeviceTimerDays</label>

								</div>
									-->
							</div>
							<div id="divDeviceRunningTime" class="row">
								<div class="input-field col s3">
									<input type="text" id="DeviceTimerMinRunningtime" class="value" />
									<label for="DeviceTimerMinRunningtime" class="translate">DeviceTimerMinRunningtime</label>
								</div>
								<div class="input-field col s3">
									<input type="text" id="DeviceTimerMaxRunningtime" class="value" />
									<label for="DeviceTimerMaxRunningtime" class="translate">DeviceTimerMaxRunningtime</label>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="modal-footer">
					<a class="modal-action modal-close waves-effect waves-green btn btn-set"><i class="large material-icons left">check</i><span class="translate">Ok</span></a>
					<a class="modal-action modal-close waves-effect waves-green btn btn-close"><i class="large material-icons left">close</i><span class="translate">Cancel</span></a>
				</div>


			</div>
		</div>
	</div>
</body>

</html>